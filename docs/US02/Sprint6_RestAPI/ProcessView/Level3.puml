@startuml

title US02: As an Administrator, I want to configure degree access methods in the system.\n(Process View - Level 3 - Backend)

skinparam defaultTextAlignment center
skinparam shadowing true


autonumber

participant ":Router" as router
-> router: configureAccessMethod(JSON)
activate router #LightBlue
note over router: The conversion from JSON to DTO is done\n automatically through the Spring Boot Framework

participant ":AccessMethodRESTController" as Controller
router -> Controller: configureAccessMethod(accessMethodRequestDTO)
activate Controller #LightBlue

ref over Controller
    Convert accessMethodRequestDTO to accessMethodCommand
end

participant ":IAccessMethodService" as service
Controller -> service: configureAccessMethod\n (accessMethodCommand)
activate service #LightBlue

create "nameVO:NameWithNumbersAndSpecialCharsVO"
service -> "nameVO:NameWithNumbersAndSpecialCharsVO": create(command.name())

participant ":IAccessMethodFactory" as Factory
service -> Factory: createAccessMethod (nameVO)
activate Factory #LightBlue 

create "amID:AccessMethodID"
Factory -> "amID:AccessMethodID": create ()

create "am:AccessMethod"
Factory -> "am:AccessMethod": create (amID, name)
deactivate Factory

participant ":IAccessMethodRepository" as Repository
service -> Repository: getAccessMethodByName (am.name)
activate Repository #LightBlue 
Repository --> service: Optional.empty
deactivate Repository

service -> Repository: saveAccessMethod (am)
activate Repository #LightBlue 

ref over Repository
    Convert am to DataModel
end

participant ":IAccessMethodRepositorySpringData" as springDataRepository
Repository -> springDataRepository: save (amDataModel)
activate springDataRepository #LightBlue 
springDataRepository --> Repository : amDataModelSaved
deactivate springDataRepository

ref over Repository
    Convert amDataModelSaved to Domain
end

Repository --> service: amSaved
deactivate Repository


ref over service
    Convert Access Method Saved to ServiceResponse<AccessMethodResponseDTO>
end

service --> Controller: amResponse

deactivate service

Controller --> router: (201, Created) amResponse
deactivate Controller

note over router: The conversion from DTO to JSON is done\n automatically through the Spring Boot Framework

<-- router: (201, Created) JSON
deactivate router

@enduml
