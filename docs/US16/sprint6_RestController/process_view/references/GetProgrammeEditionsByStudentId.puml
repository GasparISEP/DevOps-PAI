@startuml
title: Get Programme Edition Enrollments By Student ID\n(Code View - Level 4)

autonumber

participant ":ProgrammeEditionEnrolmentController" as peeCtrl
activate peeCtrl
participant ":ProgrammeEditionEnrolmentService" as peeService
participant ":ProgrammeEditionEnrolmentRepository" as peeRepo
participant ":ProgrammeEditionEnrolmentAssembler" as peeAssembler
database DB

peeCtrl -> peeService ++: getProgrammeEditionEnrollmentsByStudentId(studentId)
peeService -> peeRepo ++: findProgrammeEditionsThatStudentIsEnrolled(studentId)
peeRepo -> DB ++: SELECT programme_edition_id FROM programme_edition_enrollments\nWHERE student_id = studentId
DB --> peeRepo --: List<ProgrammeEditionID>

peeRepo --> peeService --: List<ProgrammeEditionID>
peeService --> peeCtrl --: List<ProgrammeEditionID>

peeCtrl -> peeAssembler ++: toDtoList(List<ProgrammeEditionID>)

loop for ProgrammeEditionID[i]
    note over of peeAssembler
        Invokes ProgrammeEditionEnrolmentDetailDTO
             to construct object
    end note
end
peeAssembler --> peeCtrl --: List<ProgrammeEditionEnrolmentDetailDTO>

legend right
  DTO = Data Transfer Object
  Assembler = Convert Domain to DTO
end legend

@enduml 