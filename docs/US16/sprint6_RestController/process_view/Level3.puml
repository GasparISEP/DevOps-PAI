@startuml
autonumber

skinparam sequence {
    LifelineBorderColor black
    LifelineBackgroundColor LightBlue
    ActorBorderColor black
    ActorBackgroundColor LightGray
}

title US16: Enroll a Student in a Course Edition\nProcess View â€“ Level 3

actor ASC as "Academic Services Coordinator"
participant ":Frontend" as FE
participant ":Router" as RT
participant ":Controller" as CT
participant ":Service" as SE
participant ":Factory" as FA
participant ":Domain" as DM
participant ":Repository" as RE
participant ":Driver" as Driver

ASC -> FE ++: Request to enroll a student
FE --> ASC --: Prompt: "Enter student ID"
ASC -> FE ++: Input: "12345"
FE --> ASC --: Display programme editions
ASC -> FE ++: Select programme edition
FE --> ASC --: Display course editions
ASC -> FE ++: Select course edition

FE -> RT ++: (POST) /courseeditions/students/enrolments with JSON {request}
RT -> CT ++: Forward request

CT -> SE ++: enrollStudentInCourseEdition(CourseEditionEnrolmentDto)

SE -> FA ++: createCourseEditionEnrolment(CourseEditionID, StudentID)
FA -> DM ++: new CourseEditionEnrolment()
DM --> FA --: CourseEditionEnrolment
FA --> SE --: CourseEditionEnrolment

SE -> RE ++: save(CourseEditionEnrolment)
RE -> Driver: persist
RE --> SE --: Persisted CourseEditionEnrolment

SE --> CT --: CourseEditionEnrolment

CT --> RT --: HTTP 201 Created **with Location header and enriched DTO**

RT --> FE --: HTTP 201 Created **with Location header and enriched DTO**
FE --> ASC --: Student enrolled successfully with navigation links

@enduml