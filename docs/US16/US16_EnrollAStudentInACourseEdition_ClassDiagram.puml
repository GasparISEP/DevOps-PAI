@startuml
!pragma layout smetana

class US16_EnrollAStudentInACourseEditionController {
    +US16_EnrollAStudentInACourseEditionController(ceeRepository: CourseEditionEnrollmentRepository,
    peeRepository: ProgrammeEditionEnrollmentRepo , courseEditionRepository: CourseEditionRepository)
    +enrollStudentInCourseEdition(student: Student, courseEdition: CourseEdition): boolean
    +findProgrammeEditionsThatStudentIsEnrolled(student: Student): List<ProgrammeEdition>
    +findCourseEditionsByProgrammeEdition(programmeEdition: ProgrammeEdition): List<CourseEdition>
}

class CourseEditionEnrollmentFactoryImpl{
    +createCourseEditionEnrollment(student: Student, courseEdition: CourseEdition)
}

class CourseEditionEnrollment {
    -_enrollmentDate: LocalDate
    - _isActive: boolean
    +CourseEditionEnrollment(student:Student, courseEdition: CourseEdition)
    +equals (obj: Object): boolean
}

interface ICourseEditionEnrollmentListFactory{
    +getCourseEditionEnrollmentList(): Set<CourseEditionEnrollment>
}

class CourseEditionEnrollmentListFactoryImpl {
    +getCourseEditionEnrollmentList(): Set<CourseEditionEnrollment>
}

interface ICourseEditionEnrollmentFactory{
    +createCourseEditionEnrollment(student: Student, courseEdition: CourseEdition)
}

class CourseEditionEnrollmentRepository {
    +CourseEditionEnrollmentRepository (courseEditionEnrollmentFactory: ICourseEditionEnrollmentFactory, courseEditionEnrollmentListFactory: ICourseEditionEnrollmentListFactory)
    +enrollStudentInACourseEdition (student: Student, courseEdition: CourseEdition): boolean
}

class ProgrammeEditionEnrollment {
    -_enrollmentDate: LocalDate
    +ProgrammeEditionEnrollment(student:Student, programmeEdition: ProgrammeEdition)
    +findStudentInProgrammeEditionEnrollment () : Student
    +findProgrammeEditionInEnrollment () : ProgrammeEdition
}

interface CourseEditionEnrollmentSet {
    +add(courseEditionEnrollment: CourseEditionEnrollment): boolean
}

class ProgrammeEditionEnrollmentRepo {
    +ProgrammeEditionEnrollmentRepo(programmeEditionEnrollmentFactory: ProgrammeEditionEnrollmentFactory)
    +findProgrammeEditionsThatStudentIsEnrolled(student: Student): List<ProgrammeEdition>
}

class Student {
    -_uniqueNumber:String
    -_name:String
    -_NIF:String
    -_phone:String
    -_email:String
    -_institutionalEmail:Sring
    +Student(uniqueNumber: String, name: String, NIF: String, phone: String, email: String, address: Address)
}

class Address {
     -_street:String
     -_postalCode: String
     -_location: String
     -_country: String
     +Address(street: String, postalCode: String, location: String, country: String)
}

class CourseEdition {
    +CourseEdition(programmeEdition: ProgrammeEdition, course: Course)
    +whatProgrammeEditionBelongsThisCourseEdition () : ProgrammeEdition
}

class CourseEditionRepository {
    +CourseEditionRepository(courseEditionFactory: CourseEditionFactory)
    +findCourseEditionsByProgrammeEdition(programmeEdition: ProgrammeEdition) : List<ProgrammeEdition>
}

CourseEdition "_listOfCE * " <-u- "1  " CourseEditionRepository
Student "  _student  1 " <-u- " * " CourseEditionEnrollment
CourseEditionEnrollment "    *  " --> "    _cE  1            " CourseEdition
ProgrammeEditionEnrollment "      *  " -u-> "_student 1    " Student
ProgrammeEditionEnrollment " *    " <-- "1 " ProgrammeEditionEnrollmentRepo
US16_EnrollAStudentInACourseEditionController "1 "..> "1  " CourseEditionRepository
US16_EnrollAStudentInACourseEditionController "1"..> "1     " ProgrammeEditionEnrollmentRepo
US16_EnrollAStudentInACourseEditionController "1 "..> "  1  " CourseEditionEnrollmentRepository
Address "1 _address            " <-u- "  1" Student
CourseEditionEnrollmentSet "   1            " -u->  "_setOfCee *" CourseEditionEnrollment
CourseEditionEnrollmentRepository " 1" -u-> "_setOfCee  1       " CourseEditionEnrollmentSet
CourseEditionEnrollmentRepository"   1  " ..> " *   "CourseEditionEnrollment
ICourseEditionEnrollmentFactory <|.. CourseEditionEnrollmentFactoryImpl
ICourseEditionEnrollmentListFactory <|.. CourseEditionEnrollmentListFactoryImpl
CourseEditionEnrollmentRepository "1" .u.> "1" ICourseEditionEnrollmentListFactory
CourseEditionEnrollmentRepository "1" ..> "_ceeFactory  1      " ICourseEditionEnrollmentFactory
ICourseEditionEnrollmentFactory "1" ..> "1" CourseEditionEnrollment
ICourseEditionEnrollmentListFactory "1" .u.> "1" CourseEditionEnrollmentSet

@enduml