@startuml
autonumber
skinparam sequenceMessageAlign center
title US08: I want to register a Student in the system

actor ASC
participant ":UI" as UI #implementation
participant "ctrl1:RegisterStudentInSystemController" as ctrl #lightyellow
participant "sr1:StudentRepository" as SR #lightcyan
participant "s[i]:Student" as Student #strategy
participant "sf1:StudentFactory" as SF #technology
participant "s1:Student" as s1 #strategy
participant "af1:AddressFactory" as AF #motivation
participant "address1:Address" as A #physical

ASC -> UI: I want to register a student in the system
activate UI
UI --> ASC: What is the Student's information?
ASC -> UI: uniqueNumber, name, NIF, phone, email, \n street, postalCode, location, country, academicEmail

UI -> ctrl: I want to register a Student in the system \n (uniqueNumber, name, NIF, phone, email, \n street, postalCode, location, country, academicEmail)
activate ctrl

ref over ctrl
    Convert studentID, name, NIF, phone, email,
    street, postalCode, location, country, academicEmail to Value Object
end ref

ctrl -> SR: registerStudent \n (studentIDVO, nameVO, NIFVO, phoneVO, emailVO, \n streetVO, postalCodeVO, locationVO, countryVO)
activate SR

SR -> SF: newStudent \n (studentIDVO, nameVO, NIFVO, phoneVO, emailVO, \n streetVO, postalCodeVO, locationVO, countryVO)
activate SF

SF --> AF: createAddress \n (streetVO, postalCodeVO, locationVO, countryVO)
activate AF

AF --> A**: new Address \n (streetVO, postalCodeVO, locationVO, countryVO)
activate A
A --> AF: address1
deactivate A

AF --> SF: address1
deactivate AF
SF --> s1**: new Student \n (studentIDVO, nameVO, NIFVO, phoneVO, emailVO, address1)
activate s1
s1 --> SF: s1
deactivate s1
SF --> SR: s1
deactivate SF

SR -> SR : isStudentRepeated(s1)

loop for each Student in SR
    SR -> Student: isEquals(s1) || sameAs(s1)
    activate Student
end

Student --> SR : False
deactivate Student

SR -> SR: save(s1)
SR --> ctrl: True
deactivate SR
ctrl --> UI: True
deactivate ctrl
UI --> ASC: Success!
deactivate UI

@enduml