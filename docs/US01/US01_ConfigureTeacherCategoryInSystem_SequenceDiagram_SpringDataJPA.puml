@startuml
actor admin
autonumber

title: US01 - Sequence Diagram - Configure TeacherCategory (Spring Data JPA)

skinparam sequenceLifeLineBackgroundColor #application
skinparam linetype ortho
skinparam nodesep 120
skinparam ranksep 100

participant UI
participant ":US01_ConfigureTeacherCategoryController" as Controller
participant ":ITeacherCategoryApplicationService" as AppServiceInterface
participant ":TeacherCategoryApplicationService" as AppServiceImpl
participant ":Name (VO)" as NameVO
participant ":ITeacherCategoryRepository" as Repository
participant ":ITeacherCategoryFactory" as Factory
participant ":TeacherCategory" as DomainAggregate
participant ":ITeacherCategoryMapper" as Mapper
participant ":SpringDataRepository" as JpaRepo
participant ":TeacherCategoryDataModel" as DataModel

== START: Interaction with UI ==
admin -> UI ++ : "I want to register a new TeacherCategory"
UI --> admin -- : "Please provide category name"

admin -> UI ++ : "Expert"
UI -> Controller ++ : configureTeacherCategory("Expert")

== CONTROLLER calls ApplicationService via interface ==
Controller -> AppServiceInterface ++ : registerCategory("Expert")
AppServiceInterface -> AppServiceImpl ++ : registerCategory("Expert")

== SERVICE creates Value Object ==
AppServiceImpl -> NameVO ++ : new Name("Expert")
NameVO --> AppServiceImpl -- : validated Name object

== SERVICE checks if category exists ==
AppServiceImpl -> Repository ++ : existsByName(name)
Repository -> JpaRepo ++ : existsByName(name.getName())
JpaRepo --> Repository -- : false
Repository --> AppServiceImpl -- : false

== SERVICE creates Aggregate using Factory ==
AppServiceImpl -> Factory ++ : createTeacherCategory(name)
Factory -> DomainAggregate ++ : new TeacherCategory(id, name)
Factory --> AppServiceImpl -- : TeacherCategory

== SERVICE persists category ==
AppServiceImpl -> Repository ++ : save(TeacherCategory)
Repository -> Mapper ++ : toDataModel(TeacherCategory)
Mapper -> DataModel ++ : create(id, name)
Mapper --> Repository -- : TeacherCategoryDataModel
Repository -> JpaRepo ++ : save(TeacherCategoryDataModel)
JpaRepo --> Repository -- : saved
Repository --> AppServiceImpl -- : saved aggregate

== RESULT to controller and UI ==
AppServiceImpl --> AppServiceInterface -- : success
AppServiceInterface --> Controller -- : true
Controller --> UI -- : true
UI --> admin -- : "TeacherCategory registered successfully"

@enduml
