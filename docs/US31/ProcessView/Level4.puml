@startuml
autonumber

title As an ASC, I want to register a programme in the system.


participant "pCtrl:ProgrammeRestController" as C #implementation
participant "pService:ProgrammeService" as PS #physical
participant "pFactory:ProgrammeFactory" as PF #strategy
participant "PID1:ProgrammeId" as PID #lightgrey
participant "P1:Programme" as P #lightpink
participant "pRepo:ProgrammeRepository" as PR #lightcyan



 -> C ++: getAllDegreeTypes()

ref over C
          Get DegreeTypes List
end ref

 <-- C --: List<DegreeTypeDTO>

 -> C ++: getAllDepartments()

ref over C
          Get Departments List
end ref

 <-- C --: List<DepartmentDTO>

 -> C ++: getAllTeachers()

ref over C
          Get Teachers List
end ref

<-- C --: List<TeacherDTO>

 -> C ++: registerAProgrammeInTheSystem \n(programmeDTO)

ref over C
    Convert ProgrammeDTO
    to ProgrammeVOsDTO
end ref

C -> PS ++: registerProgramme(programmeVOsDTO)

PS -> PF ++: registerProgramme(nameVO, acronymVO, \nmaxEctsVO, quantitySemestersVO, \ndegreeTypeIDVO, departmentIDVO, teacherIDVO)

PF -> PID **: newProgrammeID(nameVO, acronymVO)
activate PID
PID --> PF --: \t PIDVO1
PF -> P **: newProgramme(nameVO, acronymVO, \nmaxEctsVO, quantitySemestersVO, \ndegreeTypeIDVO, departmentIDVO, teacherIDVO, PIDVO1)
activate P

P --> PF --: P1
PF --> PS --: P1

PS -> PR++ :containsOfIdentity(PIDVO1)
PR -> : existsById(PIDVO1)
PR <-- : False
PR --> PS-- : False
PS -> PR ++: saveProgramme(P1)

ref over PR
    Save in Database
    Convert domain object to DataModel and persist using JPA
end ref

PR --> PS --: P1

PS --> C --: P1

ref over C
    Convert P1 to ProgrammeDTO
end ref

<-- C--: ProgrammeDTO

@enduml