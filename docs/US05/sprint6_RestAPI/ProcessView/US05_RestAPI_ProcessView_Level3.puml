@startuml
autonumber

skinparam sequence {
    LifelineBorderColor black
    LifelineBackgroundColor LightBlue
    ActorBorderColor black
    ActorBackgroundColor LightGray
    GroupBorderColor #cccccc
    GroupBackgroundColor #f2f2f2
}

title US05: Register a Department in the System\nProcess View â€“ Level 3

actor ADM as "Administrator"
participant ":Frontend" as FE
participant ":RestController" as CT
participant ":Assembler" as MP
participant ":Service" as SE
participant ":Domain" as DM
participant ":MapperDataModel" as MDM
participant ":Repository" as RE
database DB

group Human Interaction
ADM -> FE ++: Request to register a department
FE --> ADM --: Prompt: "Enter department acronym"
ADM -> FE ++: Input: "DEI"
FE --> ADM --: Prompt: "Enter department name"
ADM -> FE ++: Input: "Software Engineering Department"
end group

group HTTP Request
FE -> CT ++: (POST) /departments with JSON {request}
end group

group Mapping DTO to Request
CT -> MP ++: RegisterDepartmentCommand command =\n toRegisterDepartmentCommand(request)
MP --> CT --: command
end group

group Application Service Invocation
CT -> SE ++: createAndSaveDepartment(command)

group Domain Logic
SE -> DM ++: Department department = new Department(command.acronym(), command.name())
DM --> SE --: department
end group

group Persistence
SE -> RE ++: save(department)
group Mapping Domain to DataModel
RE -> MDM ++: departmentDM = toDataModel(department)
MDM --> RE --: departmentDM
end group
RE -> DB : save(departmentDM)
group Mapping Domain to DataModel
RE -> MDM ++: departmentDM = toDomain(departmentDM)
MDM --> RE --: department
end group
RE --> SE --: Persisted department
end group

SE --> CT --: department
end group

group Mapping to DTO
CT -> MP ++: toDTO(department)
MP --> CT --: DepartmentDTO
end group

group HTTP Response
CT --> FE --: HTTP 201 Created + DepartmentDTO
FE --> ADM --: Department registered successfully
end group

@enduml
