@startuml

' US17 - Enrol a Student in a Programme Edition
' Process View - Level 2 (Frontend, Backend, DB)

autonumber

skinparam sequence {
   LifelineBorderColor black
   LifelineBackgroundColor LightBlue
}

title US17: Enrol a Student in a Programme Edition \n (Process View - Level 2)

actor ASC
participant ":Frontend" as FE <<component>>
participant ":Backend" as BE <<component>>
participant ":Database" as DB <<database>>

' Fase 1 – Consulta
ASC -> FE ++: Request programme editions for a student
FE -> BE ++: GET /students/{studentId}/programme-editions
BE -> DB ++: query ProgrammeEditions from enrolments
DB --> BE --: List of programme editions
BE --> FE --: List<ProgrammeEditionDTO>
FE --> ASC --: Show programme editions

' Fase 2 – Inscrição
ASC -> FE ++: Select a programme edition
FE -> BE ++: POST /programmeeditions/{programmeAcronym}/{programmeName}/{schoolYearId}/enrolments\nBody: studentId
BE -> DB ++: save(ProgrammeEditionEnrolment)
DB --> BE --: OK
BE --> FE --: 201 Created
FE --> ASC --: Enrolment successful

@enduml
