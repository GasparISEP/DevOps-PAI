
@startuml
title US17 - Sequence Diagram (Persona + Ação + Resultado)

actor ASC as "Academic Services Coordinator"

participant "Frontend (Vue Form)" as Frontend
participant "REST Controller" as Controller <<RESTController>>
participant "Application Service" as Service <<Service>>
participant "Domain Factory" as Factory <<Factory>>
participant "Repository" as Repository <<Repository>>
participant "Database" as DB <<H2>>

ASC -> Frontend : Submit enrolment form
Frontend -> Controller : POST /programme-edition-enrolments
Controller -> Service : enrolStudentInProgrammeEdition(StudentID, ProgrammeID, SchoolYearID)
Service -> Repository : existsByID(...)
Repository --> Service : false
Service -> Factory : create(...)
Factory --> Service : ProgrammeEditionEnrolment
Service -> Repository : save(ProgrammeEditionEnrolment)
Repository --> Service : void
Service --> Controller : void
Controller --> Frontend : 200 OK

@enduml
